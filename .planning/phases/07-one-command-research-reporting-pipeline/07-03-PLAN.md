---
phase: 07-one-command-research-reporting-pipeline
plan: "03"
type: execute
wave: 2
depends_on:
  - "01"
  - "02"
files_modified:
  - scripts/generate_research_report.py
  - src/reporting.py
  - templates/research_report.md.j2
  - tests/test_research_report_generation.py
autonomous: true
user_setup: []
must_haves:
  truths:
    - Markdown report generation is deterministic and driven by the manifest/context contract.
    - Report includes methodology explanations and links to generated charts/tables.
    - Section content is script-generated rather than manual notebook text.
  artifacts:
    - scripts/generate_research_report.py
    - templates/research_report.md.j2
    - artifacts/reports/phase7/report.md
    - tests/test_research_report_generation.py
  key_links:
    - generate_research_report.py reads provenance manifest and emits one canonical Markdown report.
    - template sections map directly to phase outputs (analysis, models, explainability, diagnostics).
    - report metadata block includes generation timestamp, git sha, and pipeline run id.
---

<objective>
Generate the canonical Markdown research report from manifest-backed data.

Purpose: satisfy `RPT-02` and ensure report text stays synchronized with reproducible artifacts.
Output: templated Markdown report builder, reusable template, and contract tests.
</objective>

<execution_context>
@/home/dusitnober/.codex/get-shit-done/workflows/execute-plan.md
@/home/dusitnober/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-one-command-research-reporting-pipeline/07-RESEARCH.md
@.planning/phases/07-one-command-research-reporting-pipeline/07-01-SUMMARY.md
@.planning/phases/07-one-command-research-reporting-pipeline/07-02-SUMMARY.md
@scripts/build_report_manifest.py
@src/reporting.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement Markdown report generator</name>
  <files>scripts/generate_research_report.py, src/reporting.py</files>
  <action>Create generator that loads `provenance_manifest.json`, computes derived tables/highlights, and writes `artifacts/reports/phase7/report.md`. Include sections for methods, data quality, phase 3/4 findings, model comparisons, transformer/XAI insights, and label diagnostics. Ensure generator fails clearly when required manifest segments are missing.</action>
  <verify>`python scripts/generate_research_report.py --manifest artifacts/reports/phase7/provenance_manifest.json --output artifacts/reports/phase7/report.md` produces report with all required sections.</verify>
  <done>Report Markdown is reproducibly generated from machine-readable inputs.</done>
</task>

<task type="auto">
  <name>Task 2: Add report template with stable section ordering</name>
  <files>templates/research_report.md.j2</files>
  <action>Create a Jinja2 template that receives normalized context and renders stable heading structure, figure/table references, and methodological notes. Keep placeholders explicit so missing context fails rendering rather than silently skipping sections.</action>
  <verify>`rg -n "## Methodology|## Core Analyses|## Modeling|## Explainability|## Label Quality|## Reproducibility" templates/research_report.md.j2` confirms required section skeleton.</verify>
  <done>Report formatting and structure are controlled by one reusable template.</done>
</task>

<task type="auto">
  <name>Task 3: Add report generation tests</name>
  <files>tests/test_research_report_generation.py</files>
  <action>Add tests for deterministic section ordering, mandatory section presence, reproducibility metadata block, and figure/table path references sourced from manifest entries.</action>
  <verify>`pytest -q tests/test_research_report_generation.py` passes contract checks.</verify>
  <done>Markdown report generation is regression-safe and requirement-aligned.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `python scripts/generate_research_report.py --manifest artifacts/reports/phase7/provenance_manifest.json --output artifacts/reports/phase7/report.md`
- [ ] `pytest -q tests/test_research_report_generation.py`
- [ ] `rg -n "^## " artifacts/reports/phase7/report.md`
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Markdown report includes methods + chart/table references + reproducibility metadata
- Report content is generated from manifest inputs, not manual edits
</success_criteria>

<output>
After completion, create `.planning/phases/07-one-command-research-reporting-pipeline/07-03-SUMMARY.md`
</output>
