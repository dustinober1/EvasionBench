---
phase: 07-one-command-research-reporting-pipeline
plan: "02"
type: execute
wave: 1
depends_on: []
files_modified:
  - scripts/run_research_pipeline.py
  - dvc.yaml
  - Makefile
  - tests/test_research_pipeline_smoke.py
autonomous: true
user_setup: []
must_haves:
  truths:
    - A single command executes the full research pipeline from data through report outputs.
    - Pipeline logs each stage with explicit pass/fail status and fails fast on errors.
    - One-command path can be invoked consistently via script, Make, and DVC stage entrypoints.
  artifacts:
    - scripts/run_research_pipeline.py
    - dvc.yaml (phase7_report_pipeline stage)
    - Makefile (report-phase7 target)
    - tests/test_research_pipeline_smoke.py
  key_links:
    - scripts/run_research_pipeline.py orchestrates all required phase scripts in deterministic order.
    - dvc.yaml exposes reproducible phase7 stage tied to report outputs.
    - Makefile wraps the canonical one-command path used by developers and CI.
---

<objective>
Implement one-command orchestration for the entire reporting pipeline.

Purpose: satisfy `RPT-01` with a script-first, reproducible command path that is easy to run and debug.
Output: orchestration script, DVC/Make integration, and smoke coverage.
</objective>

<execution_context>
@/home/dusitnober/.codex/get-shit-done/workflows/execute-plan.md
@/home/dusitnober/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-one-command-research-reporting-pipeline/07-RESEARCH.md
@scripts/prepare_data.py
@scripts/run_phase3_analyses.py
@scripts/run_phase4_analyses.py
@scripts/run_classical_baselines.py
@scripts/run_transformer_baselines.py
@scripts/run_explainability_analysis.py
@scripts/run_transformer_explainability.py
@scripts/run_label_diagnostics.py
@dvc.yaml
@Makefile
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build phase-7 orchestration entrypoint</name>
  <files>scripts/run_research_pipeline.py</files>
  <action>Create a script-first orchestrator that runs required stage commands in deterministic order, writes per-stage logs to `artifacts/reports/phase7/logs/`, and supports `--skip-existing` plus `--from-stage` options for iterative reruns. Exit non-zero on first stage failure and print concise remediation hints.</action>
  <verify>`python scripts/run_research_pipeline.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/reports/phase7 --skip-existing` executes or fails with clear stage-level diagnostics.</verify>
  <done>Users can run one command for end-to-end report pipeline execution.</done>
</task>

<task type="auto">
  <name>Task 2: Wire Make and DVC stage for reproducibility</name>
  <files>Makefile, dvc.yaml</files>
  <action>Add `report-phase7` Make target and `phase7_report_pipeline` DVC stage that invoke the canonical orchestration script and declare report outputs as tracked artifacts.</action>
  <verify>`make report-phase7` and `dvc repro phase7_report_pipeline` resolve to the same canonical orchestration path.</verify>
  <done>One-command pipeline is reproducible through established project workflows.</done>
</task>

<task type="auto">
  <name>Task 3: Add orchestration smoke tests</name>
  <files>tests/test_research_pipeline_smoke.py</files>
  <action>Add smoke tests that validate ordered stage invocation, fail-fast behavior, non-zero exit on failure, and creation of stage log files and run summary metadata.</action>
  <verify>`pytest -q tests/test_research_pipeline_smoke.py` passes for success and failure-path cases.</verify>
  <done>Pipeline orchestration behavior is protected against regressions.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `python scripts/run_research_pipeline.py --output-root artifacts/reports/phase7 --skip-existing`
- [ ] `pytest -q tests/test_research_pipeline_smoke.py`
- [ ] `make report-phase7`
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Single command executes full pipeline with actionable failures
- DVC and Make invoke same canonical command path
</success_criteria>

<output>
After completion, create `.planning/phases/07-one-command-research-reporting-pipeline/07-02-SUMMARY.md`
</output>
