---
phase: 05-classical-baseline-modeling
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/models.py
  - src/evaluation.py
  - scripts/run_classical_baselines.py
  - dvc.yaml
  - docs/mlflow_guide.md
  - tests/test_classical_baseline_contract.py
autonomous: true
user_setup: []
must_haves:
  truths:
    - Phase 5 baselines execute through one script-first orchestration command with deterministic parameters.
    - Every classical model family writes a shared evaluation contract including per-class metrics and confusion matrices.
    - DVC stages and MLflow metadata are wired for reproducible, traceable baseline reruns.
  artifacts:
    - scripts/run_classical_baselines.py
    - src/evaluation.py
    - dvc.yaml
    - tests/test_classical_baseline_contract.py
    - docs/mlflow_guide.md
  key_links:
    - scripts/run_classical_baselines.py invokes family-specific baseline runners with shared CLI args.
    - src/evaluation.py exposes a canonical writer for metrics, per-class report, confusion matrix, and metadata payload.
    - dvc.yaml adds phase-5 baseline stages with deterministic deps/outs rooted in prepared data.
---

<objective>
Establish the shared classical baseline execution and artifact contract for Phase 5.

Purpose: create a stable foundation so logistic and tree/boosting plans can run in parallel while producing compatible outputs.
Output: orchestration entrypoint, contract validation tests, DVC wiring, and documentation updates.
</objective>

<execution_context>
@/Users/dustinober/.codex/get-shit-done/workflows/execute-plan.md
@/Users/dustinober/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-classical-baseline-modeling/05-RESEARCH.md
@scripts/run_experiment.py
@src/models.py
@src/evaluation.py
@dvc.yaml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define and enforce phase-5 classical baseline artifact contract</name>
  <files>src/evaluation.py, tests/test_classical_baseline_contract.py</files>
  <action>Extend evaluation helpers so each run emits deterministic `metrics.json`, `classification_report.json`, `confusion_matrix.json`, and run metadata (model family, split seed, feature config). Add schema tests that fail on missing required keys.</action>
  <verify>`pytest -q tests/test_classical_baseline_contract.py` validates required files/keys and deterministic ordering.</verify>
  <done>All baseline families can publish comparable, report-ready outputs using one contract.</done>
</task>

<task type="auto">
  <name>Task 2: Add unified phase-5 runner and Make target</name>
  <files>scripts/run_classical_baselines.py, Makefile</files>
  <action>Create a script-first runner supporting `--families {all,logreg,tree,boosting}` plus shared args (`--input`, `--output-root`, `--random-state`, `--tracking-uri`, `--experiment-name`). Add Make target `model-phase5` that calls the canonical command.</action>
  <verify>`python scripts/run_classical_baselines.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/models/phase5 --families all` completes without notebook dependencies.</verify>
  <done>Contributors can execute all Phase-5 classical baselines from one deterministic command.</done>
</task>

<task type="auto">
  <name>Task 3: Wire DVC stages and update model-tracking docs</name>
  <files>dvc.yaml, docs/mlflow_guide.md</files>
  <action>Add DVC stages for family-level baseline runs and a combined `phase5` stage. Update docs with canonical commands, expected artifacts, and provenance fields used by downstream report/dashboard layers.</action>
  <verify>`dvc repro` includes `phase5` baseline stages and docs contain `run_classical_baselines.py` usage.</verify>
  <done>Phase-5 baselines are reproducible and operationally documented.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pytest -q tests/test_classical_baseline_contract.py`
- [ ] `python scripts/run_classical_baselines.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/models/phase5 --families all`
- [ ] `dvc repro`
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Shared baseline contract/orchestration is reproducible and ready for parallel family implementation
</success_criteria>

<output>
After completion, create `.planning/phases/05-classical-baseline-modeling/05-01-SUMMARY.md`
</output>
