---
phase: 05-classical-baseline-modeling
plan: "03"
type: execute
wave: 2
depends_on:
  - "01"
files_modified:
  - src/models.py
  - scripts/train_tree_baseline.py
  - scripts/run_classical_baselines.py
  - tests/test_classical_tree_baseline.py
autonomous: true
user_setup: []
must_haves:
  truths:
    - At least one tree/boosting classical baseline trains and evaluates from scripts.
    - Tree/boosting runs emit per-class metrics and confusion matrices using the shared contract.
    - Model-family metadata is tracked consistently for cross-family comparisons.
  artifacts:
    - src/models.py
    - scripts/train_tree_baseline.py
    - tests/test_classical_tree_baseline.py
    - artifacts/models/phase5/tree_boosting/*
  key_links:
    - src/models.py includes deterministic tree/boosting trainer(s) with explicit hyperparameters and seed.
    - scripts/train_tree_baseline.py executes family-specific training/eval and writes contract artifacts.
    - run_classical_baselines.py orchestrates tree/boosting runs under the same output-root conventions.
---

<objective>
Implement the tree/boosting baseline family for Phase 5.

Purpose: satisfy `MODL-02` and provide a strong non-linear classical comparator to logistic regression.
Output: tree/boosting training script, contract-compliant evaluation artifacts, and tests.
</objective>

<execution_context>
@/Users/dustinober/.codex/get-shit-done/workflows/execute-plan.md
@/Users/dustinober/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-classical-baseline-modeling/05-RESEARCH.md
@.planning/phases/05-classical-baseline-modeling/05-01-SUMMARY.md
@src/models.py
@src/evaluation.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add deterministic tree/boosting training path in model utilities</name>
  <files>src/models.py, scripts/train_tree_baseline.py</files>
  <action>Implement at least one tree/boosting baseline (for example `RandomForestClassifier` and/or `HistGradientBoostingClassifier`) with explicit seed and reproducible preprocessing/splits. Persist model config and training metadata.</action>
  <verify>`python scripts/train_tree_baseline.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/models/phase5/tree_boosting --random-state 42` completes and writes artifacts.</verify>
  <done>Phase 5 has a reproducible tree/boosting comparator baseline.</done>
</task>

<task type="auto">
  <name>Task 2: Emit full per-class evaluation artifacts for tree/boosting runs</name>
  <files>scripts/train_tree_baseline.py, src/evaluation.py</files>
  <action>Use the shared contract writer to emit aggregate metrics, per-class report, confusion matrix, and run metadata for tree/boosting runs under the phase-5 artifact root.</action>
  <verify>`python scripts/run_classical_baselines.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/models/phase5 --families tree` produces required artifact files.</verify>
  <done>`MODL-04` requirements are met for the tree/boosting family.</done>
</task>

<task type="auto">
  <name>Task 3: Add tree/boosting baseline tests</name>
  <files>tests/test_classical_tree_baseline.py</files>
  <action>Add tests for expected output schema, deterministic behavior on fixtures, and failure handling when required columns are missing.</action>
  <verify>`pytest -q tests/test_classical_tree_baseline.py` passes with deterministic and negative-case checks.</verify>
  <done>Tree/boosting baseline is validated for scripted automation.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `python scripts/train_tree_baseline.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/models/phase5/tree_boosting --random-state 42`
- [ ] `python scripts/run_classical_baselines.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/models/phase5 --families tree`
- [ ] `pytest -q tests/test_classical_tree_baseline.py`
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- `MODL-02` and tree-side `MODL-04` outputs are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/05-classical-baseline-modeling/05-03-SUMMARY.md`
</output>
