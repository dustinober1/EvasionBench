---
phase: 03-statistical-linguistic-core-analyses
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/analysis/artifacts.py
  - scripts/run_phase3_analyses.py
  - dvc.yaml
  - Makefile
  - docs/analysis_workflow.md
  - tests/test_phase3_artifact_contract.py
autonomous: true
user_setup: []
must_haves:
  truths:
    - Phase 3 analyses execute through script-first entrypoints with deterministic paths and parameters.
    - Analysis artifacts are versioned and discoverable through a stable contract for downstream reporting.
    - DVC stages capture analysis dependencies and outputs so reruns are reproducible.
  artifacts:
    - src/analysis/artifacts.py
    - scripts/run_phase3_analyses.py
    - dvc.yaml
    - Makefile
    - docs/analysis_workflow.md
    - tests/test_phase3_artifact_contract.py
  key_links:
    - scripts/run_phase3_analyses.py invokes family-specific analysis scripts with shared output-root arguments.
    - src/analysis/artifacts.py defines canonical output directories and metadata/index writer behavior.
    - dvc.yaml adds reproducible analysis stages wired to `data/processed/evasionbench_prepared.parquet`.
---

<objective>
Create the shared execution and artifact contract for all Phase 3 analyses.

Purpose: Ensure every downstream statistical/linguistic analysis writes consistent, report-consumable artifacts through reproducible script-first stages.
Output: Shared artifact helpers, phase-level orchestration script, DVC stage wiring, and tests/docs for the contract.
</objective>

<execution_context>
@/Users/dustinober/.codex/get-shit-done/workflows/execute-plan.md
@/Users/dustinober/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-statistical-linguistic-core-analyses/03-RESEARCH.md
@dvc.yaml
@scripts/prepare_data.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define canonical phase-3 artifact contract and index metadata</name>
  <files>src/analysis/artifacts.py, tests/test_phase3_artifact_contract.py</files>
  <action>Create shared utilities that build deterministic output paths for tables/figures/summaries and write a machine-readable artifact index (for example `artifacts/analysis/phase3/artifact_index.json`) with stage name, generated files, and source data pointers. Add tests for path determinism and required index fields.</action>
  <verify>`pytest -q tests/test_phase3_artifact_contract.py` passes and validates required index keys/paths.</verify>
  <done>Every phase-3 analysis can emit outputs in one consistent schema usable by report generation.</done>
</task>

<task type="auto">
  <name>Task 2: Add phase-level orchestration entrypoint for analysis runs</name>
  <files>scripts/run_phase3_analyses.py, Makefile</files>
  <action>Implement a script-first orchestration command that runs all phase-3 analysis families (core stats, lexical/n-gram, readability/POS/discourse) with explicit CLI args for input parquet and output root. Add a Make target (for example `analysis-phase3`) that calls this script.</action>
  <verify>`python scripts/run_phase3_analyses.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/analysis/phase3` completes without notebook dependencies.</verify>
  <done>Contributors can execute all phase-3 analyses from one canonical script command.</done>
</task>

<task type="auto">
  <name>Task 3: Wire phase-3 analyses into reproducible DVC stages and docs</name>
  <files>dvc.yaml, docs/analysis_workflow.md</files>
  <action>Add phase-3 analysis stages to DVC with explicit deps/outs and document command usage, expected artifacts, and troubleshooting steps. Ensure stage names align with scripts and output locations.</action>
  <verify>`dvc repro` includes the new analysis stages and `rg -n "phase3|analysis-phase3|dvc repro" docs/analysis_workflow.md` confirms naming consistency.</verify>
  <done>Phase-3 analysis outputs are versioned and reproducibly generated through DVC + documented script-first workflows.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pytest -q tests/test_phase3_artifact_contract.py`
- [ ] `python scripts/run_phase3_analyses.py --input data/processed/evasionbench_prepared.parquet --output-root artifacts/analysis/phase3 --families all`
- [ ] `dvc repro`
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Phase-3 artifact contract and orchestration are operational and reproducible
</success_criteria>

<output>
After completion, create `.planning/phases/03-statistical-linguistic-core-analyses/03-01-SUMMARY.md`
</output>
